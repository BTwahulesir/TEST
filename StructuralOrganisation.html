<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Vishwajeet Science Academy</title>
  <style>
    body {
      font-family: 'Poppins', Arial, sans-serif;
      background: #f4f7fc;
      margin: 0;
      padding: 0;
      min-height: 100vh;
    }
    .page-border {
      min-height: 100vh;
      border: 6px solid #1e90ff;
      border-radius: 20px;
      margin: 0;
      background: white;
      box-shadow: 0 0 35px #a0befd;
      display: flex;
      justify-content: center;
      align-items: flex-start;
      padding: 20px 0;
    }
    .container {
      width: 97%;
      max-width: 950px;
      margin: auto;
      display: flex;
      flex-direction: column;
    }
    h2.main-title {
      text-align: center;
      margin-bottom: 12px;
      font-size: 2.65rem;
      color: #E2008A;
      font-weight: 800;
    }
    .logo-img {
      display: block;
      margin: 0 auto 18px auto;
      max-width: 160px;
      width: 100%;
      height: auto;
      border-radius: 50%;
      box-shadow: 0 0 14px #a0befd;
      border: 3px solid #1e90ff;
      background: #fff;
    }
    .sub-title {
      text-align: center;
      font-size: 2.1rem;
      margin: 0 0 28px 0;
      font-family: 'cambria', serif, cursive;
      color: #047020;
      font-weight: 700;
      letter-spacing: 1px;
    }
    h4.special-author {
      text-align: center;
      font-family: 'Pacifico', 'Brush Script MT', cursive, sans-serif;
      font-size: 2rem;
      color: #6316D7;
      font-weight: 600;
      letter-spacing: 3px;
      font-style: italic;
      margin-top: 3px;
      margin-bottom: 28px;
    }
    label { font-weight:600; margin:14px 0 7px; display:block; }
    input[type=text], select {
      width:100%;
      padding:10px 12px;
      font-size:1.04em;
      border-radius:7px;
      border:1.4px solid #bbb;
      background:#f9f9fb;
      box-sizing: border-box;
    }
    #startBtn {
      margin-top:20px;
      padding:14px 40px;
      font-size:1.12em;
      font-weight:700;
      border-radius:8px;
      background:#1e90ff;
      color:white;
      border:none;
      cursor:pointer;
      transition: background-color 0.3s ease;
    }
    #startBtn:disabled { background:#a0bbd9; cursor:not-allowed; }
    #startBtn:not(:disabled):hover { background:#1970dd; }
    #quiz-section { display:none; margin-top:22px; gap:25px; flex-wrap: wrap; }
    #progress { text-align:center; margin-bottom:16px; font-size:1.1em; color:#555; }
    .question-text { font-weight:700; font-size:1.22em; margin-bottom:17px; }
    .options { margin-bottom:25px; }
    .options label.option-label {
      display:flex; align-items:center; gap:13px;
      background:#f9f9f9;
      border:2px solid #eaeaea;
      border-radius:9px;
      margin-bottom:14px;
      font-size:1.08em;
      font-weight:500;
      cursor:pointer;
      transition:all 0.18s;
      min-height:48px;
      padding:0 20px;
      box-sizing: border-box;
    }
    .options label.option-label:hover {
      border:2px solid #1976d2;
      background:#f0f9ff;
      box-shadow:0 2px 8px #1976d215;
    }
    .options input[type="radio"] {
      accent-color:#1976d2;
      appearance:none;
      width:22px; height:22px;
      border:2px solid #bbb;
      border-radius:50%;
      background:#fff;
      margin-right:10px;
      cursor: pointer;
    }
    .options input[type="radio"]:checked {
      border:7px solid #1976d2;
      background:#f3f8fd;
    }
    .options label.option-label.selected {
      border:2.5px solid #1976d2;
      background:#eef6fb;
    }
    .options .option-letter {
      font-weight:700;
      color:#1976d2;
      font-size:1.13em;
      padding-right:10px;
      user-select: none;
    }
    #navigation { text-align:center; margin-top:12px; }
    .nav-btn {
      padding:12px 26px;
      border-radius:8px;
      border:none;
      font-weight:700;
      font-size:1.1em;
      margin:0 10px;
      background:#1976d2;
      color:white;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .nav-btn:hover:not(:disabled) { background:#065ab1; }
    .nav-btn:disabled { background:#b9cce1; cursor: not-allowed; }
    #submitBtn {
      margin-top:22px;
      padding:14px 42px;
      font-weight:700;
      font-size:1.2em;
      background:#238823;
      color:white;
      border:none;
      border-radius:9px;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    #submitBtn:disabled { background:#a8d1b7; cursor: not-allowed; }
    #finish-section { display:none; margin-top:25px; }
    .card {
      width: 470px;
      max-width: 96vw;
      background:white;
      border:3px solid #1e90ff;
      border-radius:22px;
      box-shadow:0 0 18px #7bb9fd;
      padding:30px 20px;
      text-align:center;
      margin:0 auto;
      box-sizing: border-box;
    }
    .card h1 { font-size:1.4rem; margin-bottom:20px; color:#1c416b; }
    .trophy { font-size:2.3rem; margin-bottom:15px; color:#ffbb1f; }
    .details { font-size:1rem; font-weight:600; color:#444; margin-bottom:20px; }
    .score { font-size:1.25rem; font-weight:800; margin-bottom:20px; }
    .stats {
      display:flex; justify-content:center; gap:10px;
      flex-wrap:wrap; margin-bottom:20px;
    }
    .stat { flex:1; background:#f5f8fa; border-radius:10px; padding:10px; text-align:center; min-width:80px; box-sizing: border-box; }
    .stat-number {
      width:44px; height:44px; margin:0 auto 8px;
      border-radius:8px; display:flex; align-items:center;
      justify-content:center; font-weight:700; font-size:1.2em;
    }
    .stat.attempted .stat-number { background:#197fd6; color:white; }
    .stat.correct .stat-number { background:#08ad6c; color:white; }
    .stat.wrong .stat-number { background:#d64541; color:white; }
    .stat.notattempted .stat-number { background:#ddd; color:#333; }
    #question-navigator {
      margin-left:24px; width:210px;
      display:grid; grid-template-columns:repeat(5,36px);
      grid-auto-rows:36px; gap:10px;
    }
    .q-nav-btn { border-radius:6px; border:none; cursor:pointer; color:white; font-weight:700; }
    .q-nav-btn.not-attempted { background:#d64541; }
    .q-nav-btn.skipped { background:#197fd6; }
    .q-nav-btn.attempted { background:#08ad6c; }
    .q-nav-btn.current { outline:2px solid #000; }
    table.review-table {
      width:100%; border-collapse:collapse; margin-top:15px;
      table-layout: fixed;
      word-wrap: break-word;
    }
    table.review-table th, table.review-table td {
      border:1px solid #ccc; padding:6px;
      vertical-align: top;
    }
    .correct{color:#08ad6c;font-weight:bold;}
    .incorrect{color:#d64541;font-weight:bold;}
    .skipped{color:#1976d2;font-weight:bold;}
    .export-btns {
      margin:22px auto 0 auto;
      display:flex; gap:15px; flex-wrap:wrap;
      justify-content:center;
    }
    @media screen and (max-width: 600px) {
      h2.main-title { font-size: 1.8rem; margin-bottom: 8px; }
      .sub-title { font-size: 1.5rem; margin-bottom: 20px; }
      h4.special-author { font-size: 1.4rem; letter-spacing: 1.5px; margin-bottom: 20px; }
      .page-border { padding: 15px 5px; }
      .container { width: 95%; max-width: 100%; padding: 0 10px; }
      #startBtn, #submitBtn, .nav-btn {
        font-size: 1em;
        padding: 12px 20px;
        margin: 10px 5px;
      }
      input[type=text], select {
        font-size: 1em;
        padding: 8px 10px;
      }
      #quiz-section { flex-direction: column; }
      #navigation { margin-top: 15px; }
      .card {
        width: 100%;
        max-width: 100%;
        padding: 20px 15px;
      }
      #question-navigator {
        margin-left: 0;
        width: 100%;
        grid-template-columns: repeat(auto-fit, minmax(30px, 1fr));
      }
      .options label.option-label {
        font-size: 1em;
        padding: 0 15px;
        min-height: 44px;
      }
      .options input[type="radio"] {
        width: 18px;
        height: 18px;
        margin-right: 8px;
      }
      .stat {
        min-width: 60px;
        padding: 8px;
        font-size: 0.85rem;
      }
      .stat-number {
        width: 36px;
        height: 36px;
        font-size: 1rem;
      }
      table.review-table th, table.review-table td {
        font-size: 0.9rem;
        padding: 4px;
      }
      .export-btns {
        gap: 8px;
        margin: 15px auto 0 auto;
      }
    }
  </style>
  <link href="https://fonts.googleapis.com/css?family=Pacifico&display=swap" rel="stylesheet" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.1/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
  <div class="page-border">
    <div class="container">
      <h2 class="main-title">VISHWAJEET SCIENCE ACADEMY</h2>
       <img src="vsa logo.jpeg" alt="vsa logo" class="logo-img" />
      <h3 class="sub-title">BIOLOGY: structural Organisation in Animals</h3>
      <h4 class="special-author">&copy; By WAHULE SIR</h4>
      <div id="login-section">
        <label for="rollno">Enter Roll Number (01-200)</label>
        <input type="text" id="rollno" maxlength="3" placeholder="e.g. 01" />
        <label for="batch">Select Batch</label>
        <select id="batch">
          <option value="">-- Select Batch --</option>
          <option value="11th">11th</option>
          <option value="12th">12th</option>
          <option value="NEET Repeater">NEET Repeater</option>
        </select>
        <button id="startBtn" disabled>Start Test</button>
      </div>

      <section id="quiz-section">
        <div style="flex:1;">
          <div id="progress"></div>
          <div id="question-block">
            <div class="question-text" id="question-text"></div>
            <form id="options-form" class="options"></form>
          </div>
          <div id="navigation">
            <button id="prevBtn" class="nav-btn" disabled>Previous</button>
            <button id="skipBtn" class="nav-btn">Skip</button>
            <button id="nextBtn" class="nav-btn" disabled>Next</button>
          </div>
          <button id="submitBtn" disabled>Submit Test</button>
        </div>
        <nav id="question-navigator"></nav>
      </section>

      <section id="finish-section">
        <div style="display:flex; flex-direction:column; align-items:center;">
          <div class="card">
            <h1>
              <span class="trophy">&#x1F3C6;</span>
              Congratulations! Your Test has been Submitted
              <span class="trophy">&#x1F3C6;</span>
            </h1>
            <div class="details" id="resultDetails"></div>
            <div id="resultScore" class="score"></div>
            <div class="stats">
              <div class="stat attempted"><div class="stat-number" id="attemptedCount">0</div><p>Attempted</p></div>
              <div class="stat correct"><div class="stat-number" id="correctCount">0</div><p>Correct</p></div>
              <div class="stat wrong"><div class="stat-number" id="wrongCount">0</div><p>Wrong</p></div>
              <div class="stat notattempted"><div class="stat-number" id="notAttemptedCount">0</div><p>Not Attempted</p></div>
            </div>
            <canvas id="piechart" width="220" height="220"></canvas>
            <div class="footer">¬© 2025 Vishwajeet Science Academy</div>
          </div>
          <div class="export-btns">
            <button class="nav-btn" id="printBtn" type="button">üñ®Ô∏è Print Report</button>
            <button class="nav-btn" id="pdfBtn" type="button">‚¨áÔ∏è Download PDF</button>
            <button class="nav-btn" id="excelBtn" type="button">‚¨áÔ∏è Export to Excel</button>
          </div>
        </div>
        <h2 id="review-heading" style="margin-top:36px;">Review Your Answers</h2>
        <div id="review-section"></div>
      </section>
    </div>
  </div>

  <script>
    const mcqs = [
      {
        q: "Which of the following epithelium is irregularly shaped?",
        a: "Squamous epithelium",
        b: "Cuboidal epithelium",
        c: "Columnar epithelium",
        d: "Ciliated columnar epithelium",
        ans: "a",
        expl: "Squamous epithelial cells tend to be irregularly shaped, adapting to their surface functions. [attached_file:1]"
    },
    {
        q: "Cuboidal epithelium can be found in",
        a: "Distal convoluted tubule",
        b: "Proximal convoluted tubule",
        c: "Henle's loop",
        d: "Both (a) and (b)",
        ans: "b",
        expl: "Proximal convoluted tubules have cuboidal epithelium for absorption and secretion. [attached_file:1]"
    },
    {
        q: "In columnar epithelium, where is nucleus located?",
        a: "At the base",
        b: "In the middle",
        c: "At the top",
        d: "No nucleus is present",
        ans: "a",
        expl: "Columnar cells usually show nucleus at the base for better organization. [attached_file:1]"
    },
    {
        q: "Which of the following is/are example of dense connective tissue?",
        a: "Tendon",
        b: "Cartilage",
        c: "Ligament",
        d: "All of these",
        ans: "a",
        expl: "Tendons are classic dense connective tissues with organized collagen fibers. [attached_file:1]"
    },
    {
        q: "What kind of tissue is goblet cells?",
        a: "Epithelial tissue",
        b: "Connective tissue",
        c: "Neural tissue",
        d: "All of these",
        ans: "a",
        expl: "Goblet cells are mucous-secreting and classified as epithelial cells. [attached_file:1]"
    },
    {
        q: "Which portion of cartilage provides it with solidity, pliability and resistance to compression?",
        a: "Collagen fibres",
        b: "Calcium content",
        c: "Intracellular material",
        d: "Chondrocytes",
        ans: "c",
        expl: "Intracellular matrix gives cartilage its compressibility and flexibility. [attached_file:1]"
    },
    {
        q: "What provides bone with hard and non-pliable properties?",
        a: "Collagen fibres",
        b: "Calcium salts",
        c: "Both (a) and (b)",
        d: "None of these",
        ans: "c",
        expl: "Both collagen and calcium salts together give bone rigidity and strength. [attached_file:1]"
    },
    {
        q: "Where are osteocytes located?",
        a: "Entire bone",
        b: "In lacunae",
        c: "Both (a) and (b)",
        d: "None of these",
        ans: "b",
        expl: "Osteocytes reside within lacunae, small cavities in bone tissue. [attached_file:1]"
    },
    {
        q: "Which of the following is not true?",
        a: "Limb bones are long bones.",
        b: "The function of long bones is weight bearing and bringing out movement.",
        c: "Bone marrows in all such long bones are site of blood cells production.",
        d: "All of these",
        ans: "c",
        expl: "Not all long bones contain active blood cell producing marrow throughout life. [attached_file:1]"
    },
    {
        q: "What is the main function of blood?",
        a: "Protection of body",
        b: "Transport of various substances",
        c: "pH buffering",
        d: "Maintaining osmolarity balance",
        ans: "b",
        expl: "Transport of nutrients, gases, and waste is blood's primary function. [attached_file:1]"
    },
    {
        q: "When muscle cells receive stimulus, they get ________.",
        a: "Shortened",
        b: "Lengthened",
        c: "Elongated",
        d: "All of these",
        ans: "a",
        expl: "Muscle contraction results in shortening of muscle fibres. [attached_file:1]"
    },
    {
        q: "Muscular movement are intended to ________.",
        a: "Move the body to adjust to changes in environment",
        b: "Maintain the position of various body parts",
        c: "Both (a) and (b)",
        d: "None of these",
        ans: "c",
        expl: "Muscle movement both maintains position and enables body adjustments. [attached_file:1]"
    },
    {
        q: "Which of the following is a typical skeletal muscle?",
        a: "Biceps",
        b: "Triceps",
        c: "Both (a) and (b)",
        d: "None of these",
        ans: "c",
        expl: "Both biceps and triceps are examples of skeletal muscles. [attached_file:1]"
    },
    {
        q: "The sheath enclosing the several bundles of muscle fibres is ________ tissue.",
        a: "epithelial",
        b: "connective",
        c: "both",
        d: "neural",
        ans: "b",
        expl: "Connective tissue covers and supports muscle fibre bundles. [attached_file:1]"
    },
    {
        q: "Which of the following is a fusiform muscle?",
        a: "Cardiac muscle",
        b: "Smooth muscle",
        c: "Both (a) and (b)",
        d: "Skeletal muscle",
        ans: "b",
        expl: "Smooth muscles have a fusiform (spindle-shaped) structure. [attached_file:1]"
    },
    {
        q: "Smooth muscles are held together by ________.",
        a: "Connective tissue",
        b: "Cell junctions",
        c: "Epithelial tissue",
        d: "None of these",
        ans: "b",
        expl: "Cell junctions join smooth muscle cells allowing coordinated contractions, forming functional sheets. [attached_file:1]"
    },
    {
        q: "Where can we find smooth muscles?",
        a: "Artery",
        b: "Vein",
        c: "Stomach",
        d: "All of these",
        ans: "d",
        expl: "Smooth muscles are present in arteries, veins, and organs like the stomach, performing involuntary movements. [attached_file:1]"
    },
    {
        q: "Assertion (A): Simple epithelium covers the surface exposed to mechanical or chemical abrasions.\nReason (R): Protection of underlying tissues is the major function of compound epithelium. Choose the correct answer.",
        a: "Both A and R are true, but R is not the correct explanation of A.",
        b: "A is true, but R is false.",
        c: "A is false, but R is true.",
        d: "Both A and R are true and R is the correct explanation of A",
        ans: "c",
        expl: "Compound epithelium provides more protection than simple epithelium, so R is true but does not explain A. [attached_file:1]"
    },
    {
        q: "Assertion (A): The surplus of nutrients which are not used immediately are converted into fats and stored in adipose tissue.\nReason (R): Adipose tissue is a type of loose connective tissue found in animals. Choose the correct answer.",
        a: "Both A and R are true, but R is not the correct explanation of A.",
        b: "A is true, but R is false.",
        c: "A is false, but R is true.",
        d: "Both A and R are true and R is the correct explanation of A",
        ans: "a",
        expl: "Both statements are true but R does not directly explain the conversion process stated in A. [attached_file:1]"
    },
    {
        q: "Assertion (A): Cell junctions are present in the epithelium and other tissues.\nReason (R): Among the three cell junctions, adhering junctions help to stop substances from leaking across a tissue. Choose the correct answer.",
        a: "Both A and R are true, but R is not the correct explanation of A.",
        b: "A is true, but R is false.",
        c: "A is false, but R is true.",
        d: "Both A and R are true and R is the correct explanation of A",
        ans: "b",
        expl: "Adhering junctions anchor cells but tight junctions prevent leakage, so R is false. [attached_file:1]"
    },
    {
        q: "Assertion (A): In frog, fertilisation is external.\nReason (R): The zygote of frog undergoes cleavage and develops into morula and blastula. Choose the correct answer.",
        a: "Both A and R are true, but R is not the correct explanation of A.",
        b: "A is true, but R is false.",
        c: "A is false, but R is true.",
        d: "Both A and R are true and R is the correct explanation of A",
        ans: "a",
        expl: "Fertilisation is external; cleavage and development follow independently, so R does not explain A. [attached_file:1]"
    },
    {
        q: "Statement I: In frog, the partially digested food called chyme is passed from stomach to the first part of small intestine.\nStatement II: The digested food in frog is absorbed by numerous finger-like folds in the inner wall of intestine. Choose the most appropriate answer.",
        a: "Both statement I and II are incorrect.",
        b: "Statement I is correct, but statement II is incorrect.",
        c: "Statement I is incorrect, but statement II is correct.",
        d: "Both statement I and II are correct.",
        ans: "d",
        expl: "Chyme passes to intestine and absorption occurs via intestinal folds (villi) in frogs. [attached_file:1]"
    },
    {
        q: "Statement I: Tendons are examples of dense irregular connective tissue.\nStatement II: The orientation of fibres showing regular or irregular pattern are called loose connective tissue. Choose the most appropriate answer.",
        a: "Both statement I and II are incorrect.",
        b: "Statement I is correct, but statement II is incorrect.",
        c: "Statement I is incorrect, but statement II is correct.",
        d: "Both statement I and II are correct.",
        ans: "b",
        expl: "Tendons are dense regular connective tissue; the statement II about loose connective tissue is incorrect. [attached_file:1]"
    },
    {
        q: "Which of the following statements are incorrect about frog?\nI. In male frog, each ureter contains a duct for transfer of sperms.\nII. Each kidney is composed of several nephrons.\nIII. In females, ureters and oviduct open separately into cloaca.\nIV. Uric acid is formed from ammonia released during deamination. Choose the correct answer.",
        a: "II only",
        b: "I and IV",
        c: "IV only",
        d: "III and IV",
        ans: "c",
        expl: "Uric acid formation from ammonia in frogs is incorrect; primarily ammonia or urea is excreted. [attached_file:1]"
    },
    {
        q: "Which of the following statements are incorrect about the respiratory system of frog?\nI. Skin acts as the only respiratory organ in water only.\nII. Dissolved oxygen is exchanged through the skin by active transport.\nIII. Lungs are paired and present in upper thorax.\nIV. On land, buccal cavity acts as one respiratory organ.\nV. Pulmonary respiration occurs during hibernation and aestivation. Choose the correct answer.",
        a: "II, III and IV",
        b: "II and V",
        c: "I, III and V",
        d: "II, IV and V",
        ans: "b",
        expl: "Oxygen exchange through skin is by diffusion, pulmonary respiration is minimal during hibernation/aestivation. [attached_file:1]"
    },
{
    q: "Which of the following statements are correct about frog? I. A mature female can lay around 2500 to 3000 ova at a time. II. Ovoid testes are found attached to the upper part of kidneys with the help of mesorchium. III. Hind brain is characterised by a pair of optic lobes. IV. Intestinal tract is lined with striated muscles. V. Special venous connection called the hepatic portal system is present between the liver and intestine.",
    a: "I and IV",
    b: "I, II and V",
    c: "I, III and IV",
    d: "III, IV and V",
    ans: "b",
    expl: "Statements I, II, and V are correct: mature female ovum count, testis attachment, and hepatic portal system are as described. [attached_file:1]"
},
{
    q: "The tissue that binds, supports and provides strength to other body tissues is",
    a: "Epithelial tissue",
    b: "Connective tissue",
    c: "Muscular tissue",
    d: "Nervous tissue",
    ans: "b",
    expl: "Connective tissue binds, supports, and provides strength to various body tissues, unlike epithelial or muscular tissues. [attached_file:1]"
},
{
    q: "All the following connective tissues have a rich supply of blood except",
    a: "Areolar connective tissue",
    b: "Adipose connective tissue",
    c: "Cartilage",
    d: "Bone",
    ans: "c",
    expl: "Cartilage is avascular and lacks a rich blood supply compared to other connective tissues like areolar, adipose, and bone. [attached_file:1]"
},
    {
        q: "Which of the following are connective tissue proper?",
        a: "Areolar connective tissue and adipose connective tissue",
        b: "Blood and lymph",
        c: "Cartilage and bone",
        d: "All of these",
        ans: "a",
        expl: "Areolar and adipose tissues are connective tissue proper; blood, lymph, cartilage and bone are specialized types. [attached_file:1]"
    },
    {
        q: "Fibroblasts produce _____.",
        a: "White fibres and yellow fibres",
        b: "Extra-cellular matrix",
        c: "Both (a) and (b)",
        d: "Neither (a) nor (b)",
        ans: "a",
        expl: "Fibroblasts synthesize white (collagen) and yellow (elastic) fibres of connective tissue. [attached_file:1]"
    },
    {
        q: "The cells of areolar tissue which engulf micro-organisms are",
        a: "Fibroblasts",
        b: "Macrophages",
        c: "Mast cells",
        d: "Adipocytes",
        ans: "b",
        expl: "Macrophages in areolar tissue phagocytose micro-organisms to protect the body. [attached_file:1]"
    },
    {
        q: "The cells of areolar tissue which store fats are",
        a: "Fibroblasts",
        b: "Macrophages",
        c: "Mast cells",
        d: "Adipocytes",
        ans: "d",
        expl: "Adipocytes store fat in areolar connective tissue. [attached_file:1]"
    },
    {
        q: "The cells of areolar tissue which are found mainly surrounding blood vessels are",
        a: "Fibroblasts",
        b: "Macrophages",
        c: "Mast cells",
        d: "Adipocytes",
        ans: "c",
        expl: "Mast cells are concentrated around blood vessels and release histamine. [attached_file:1]"
    },
    {
        q: "The cells of areolar tissue with many branching processes are",
        a: "Fibroblasts",
        b: "Macrophages",
        c: "Mast cells",
        d: "Adipocytes",
        ans: "a",
        expl: "Fibroblasts have branching processes and synthesize connective tissue fibers. [attached_file:1]"
    },
    {
        q: "Mast cells of areolar connective tissue secrete",
        a: "Heparin and histamine",
        b: "Histamine and renin",
        c: "Heparin and fibres",
        d: "Heparin, histamine and fibres",
        ans: "a",
        expl: "Mast cells secrete heparin (an anticoagulant) and histamine (inflammatory mediator). [attached_file:1]"
    },
    {
        q: "Which of the following helps in dilation of blood vessels?",
        a: "Heparin",
        b: "Histamine",
        c: "Both (a) and (b)",
        d: "Neither (a) nor (b)",
        ans: "b",
        expl: "Histamine causes blood vessel dilation during inflammatory responses. [attached_file:1]"
    },
    {
        q: "The muscles responsible for peristalsis are",
        a: "Visceral muscles",
        b: "Smooth muscles",
        c: "Cardiac muscles",
        d: "Both (a) and (b)",
        ans: "d",
        expl: "Visceral and smooth muscles cause wave-like peristalsis movement in organs. [attached_file:1]"
    },
    {
        q: "Myofibrils in a muscle fibre are arranged",
        a: "Transversely",
        b: "Longitudinally",
        c: "Either (a) or (b)",
        d: "Both (a) and (b)",
        ans: "b",
        expl: "Myofibrils run longitudinally within muscle fibers to allow contraction. [attached_file:1]"
    },
    {
        q: "Neuroglial cells",
        a: "Support neurons",
        b: "Nourish neurons",
        c: "Provide protection to neurons by phagocytosis",
        d: "All of these",
        ans: "d",
        expl: "Neuroglial cells provide support, nourishment, and protection to neurons. [attached_file:1]"
    },
    {
        q: "The membrane covering the neuron is",
        a: "Neurilemma",
        b: "Plasmalemma",
        c: "Sarcolemma",
        d: "Myolemma",
        ans: "a",
        expl: "Neurilemma is the outer membrane covering neurons. [attached_file:1]"
    },
    {
        q: "The body of the neuron is",
        a: "Perikaryon",
        b: "Cyton",
        c: "Soma",
        d: "All of these",
        ans: "d",
        expl: "Perikaryon, cyton, and soma are synonymous terms for neuron‚Äôs cell body. [attached_file:1]"
    },
    {
        q: "Nissl's granules are rich in",
        a: "RNA",
        b: "DNA",
        c: "Either (a) or (b)",
        d: "Neither (a) nor (b)",
        ans: "a",
        expl: "Nissl‚Äôs granules mainly contain RNA essential for protein synthesis. [attached_file:1]"
    },
    {
        q: "The thin cytoplasmic processes of neurons are",
        a: "Dendrons",
        b: "Axons",
        c: "Either (a) or (b)",
        d: "Neither (a) nor (b)",
        ans: "a",
        expl: "Dendrons conduct impulses toward the neuron's cell body. [attached_file:1]"
    },
    {
        q: "The thick cytoplasmic processes of neurons are",
        a: "Dendrons",
        b: "Axons",
        c: "Either (a) or (b)",
        d: "Neither (a) nor (b)",
        ans: "b",
        expl: "Axons transmit nerve impulses away from the neuron‚Äôs cell body. [attached_file:1]"
    },
    {
        q: "The cytoplasmic processes that carry impulses away from the cyton are",
        a: "Dendrons",
        b: "Axons",
        c: "Either (a) or (b)",
        d: "Neither (a) nor (b)",
        ans: "b",
        expl: "Axons are responsible for carrying impulses away from the neuron's body. [attached_file:1]"
    },
      
      // Add further MCQs if needed in similar structure...
    ];

    const rollInput = document.getElementById('rollno');
    const batchSelect = document.getElementById('batch');
    const startBtn = document.getElementById('startBtn');
    const quizSection = document.getElementById('quiz-section');
    const progressDiv = document.getElementById('progress');
    const questionText = document.getElementById('question-text');
    const optionsForm = document.getElementById('options-form');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const skipBtn = document.getElementById('skipBtn');
    const submitBtn = document.getElementById('submitBtn');
    const finishSection = document.getElementById('finish-section');
    const resultDetails = document.getElementById('resultDetails');
    const resultScore = document.getElementById('resultScore');
    const attemptedCount = document.getElementById('attemptedCount');
    const correctCount = document.getElementById('correctCount');
    const wrongCount = document.getElementById('wrongCount');
    const notAttemptedCount = document.getElementById('notAttemptedCount');
    const reviewSection = document.getElementById('review-section');
    const pieCanvas = document.getElementById('piechart');
    const questionNavigator = document.getElementById('question-navigator');

    let currentQuestionIndex = 0;
    let answers = new Array(mcqs.length).fill(undefined);

    function validateInput() {
      const roll = parseInt(rollInput.value.trim(), 10);
      startBtn.disabled = !(roll >= 1 && roll <= 200 && batchSelect.value);
    }
    rollInput.addEventListener('input', () => {
      rollInput.value = rollInput.value.replace(/\D/g, '');
      validateInput();
    });
    batchSelect.addEventListener('change', validateInput);

    startBtn.onclick = () => {
      document.getElementById('login-section').style.display = 'none';
      quizSection.style.display = 'flex';
      renderNavigator();
      loadQuestion(0);
    };

    function renderNavigator() {
      questionNavigator.innerHTML = '';
      mcqs.forEach((q, i) => {
        let btn = document.createElement('button');
        btn.textContent = i + 1;
        btn.className = 'q-nav-btn not-attempted';
        btn.dataset.index = i;
        btn.onclick = () => loadQuestion(i);
        questionNavigator.appendChild(btn);
      });
    }

    function updateNavigatorColors() {
      questionNavigator.querySelectorAll('.q-nav-btn').forEach(btn => {
        const idx = +btn.dataset.index;
        btn.classList.remove('attempted', 'skipped', 'not-attempted', 'current');
        if (idx === currentQuestionIndex) btn.classList.add('current');
        if (answers[idx] === undefined) btn.classList.add('not-attempted');
        else if (answers[idx] === null) btn.classList.add('skipped');
        else btn.classList.add('attempted');
      });
    }

    function loadQuestion(i) {
      currentQuestionIndex = i;
      const q = mcqs[i];
      questionText.textContent = `Q${i + 1}. ${q.q}`;
      optionsForm.innerHTML = '';
      ['a', 'b', 'c', 'd'].forEach(key => {
        const lbl = document.createElement('label');
        lbl.className = 'option-label';
        lbl.innerHTML = `<input type="radio" name="option" value="${key}"><span class="option-letter">(${key.toUpperCase()})</span>${q[key]}`;
        optionsForm.appendChild(lbl);
      });
      optionsForm.querySelectorAll('input[type="radio"]').forEach(radio => {
        radio.addEventListener('change', () => {
          optionsForm.querySelectorAll('label.option-label').forEach(lbl => lbl.classList.remove('selected'));
          radio.closest('label').classList.add('selected');
          nextBtn.disabled = false;
        });
      });
      if (answers[i]) {
        const sel = optionsForm.querySelector(`input[value="${answers[i]}"]`);
        if (sel) {
          sel.checked = true;
          sel.closest('label').classList.add('selected');
          nextBtn.disabled = false;
        } else {
          nextBtn.disabled = true;
        }
      } else {
        nextBtn.disabled = true;
      }
      prevBtn.disabled = (i === 0);
      progressDiv.textContent = `Question ${i + 1} of ${mcqs.length}`;
      updateNavigatorColors();
    }

    prevBtn.onclick = () => {
      if (currentQuestionIndex > 0) loadQuestion(currentQuestionIndex - 1);
    };

    nextBtn.onclick = () => {
      const sel = optionsForm.querySelector('input[name="option"]:checked');
      if (sel) {
        answers[currentQuestionIndex] = sel.value;
        submitBtn.disabled = false;
        if (currentQuestionIndex < mcqs.length - 1) loadQuestion(currentQuestionIndex + 1);
      }
    };

    skipBtn.onclick = () => {
      answers[currentQuestionIndex] = null;
      submitBtn.disabled = false;
      if (currentQuestionIndex < mcqs.length - 1) loadQuestion(currentQuestionIndex + 1);
    };

    submitBtn.onclick = () => {
      if (confirm('Submit test?')) finalizeTest();
    };

    function finalizeTest() {
      quizSection.style.display = 'none';
      finishSection.style.display = 'block';

      const total = mcqs.length;
      const correct = answers.filter((a, i) => a === mcqs[i].ans).length;
      const wrong = answers.filter((a, i) => a !== null && a !== undefined && a !== mcqs[i].ans).length;
      const attempted = answers.filter(a => a !== null && a !== undefined).length;
      const skipped = answers.filter(a => a === null).length;
      const notAttempted = answers.filter(a => a === undefined).length;
      const score = correct * 4 - wrong;
      const pct = ((score / (total * 4)) * 100).toFixed(2);

      resultDetails.innerHTML = `<strong>Roll Number:</strong> ${rollInput.value.padStart(2, '0')}<br><strong>Batch:</strong> ${batchSelect.value}`;
      resultScore.textContent = `Score: ${score} / ${total * 4} (${pct}%)`;
      resultScore.style.color = score >= 0 ? '#08ad6c' : '#d64541';

      attemptedCount.textContent = attempted;
      correctCount.textContent = correct;
      wrongCount.textContent = wrong;
      notAttemptedCount.textContent = notAttempted;

      drawPieChart(correct, wrong, skipped);
      renderReview();
    }

    function drawPieChart(c, w, s) {
      const ctx = pieCanvas.getContext('2d');
      const total = c + w + s || 1;
      const cx = 110, cy = 110, r = 100;
      ctx.clearRect(0, 0, pieCanvas.width, pieCanvas.height);
      let start = -Math.PI / 2;
      const slices = [
        { v: c, col: '#08ad6c' },
        { v: w, col: '#d64541' },
        { v: s, col: '#197fd6' }
      ];
      slices.forEach(sl => {
        if (!sl.v) return;
        const ang = (sl.v / total) * 2 * Math.PI;
        ctx.beginPath();
        ctx.moveTo(cx, cy);
        ctx.arc(cx, cy, r, start, start + ang);
        ctx.closePath();
        ctx.fillStyle = sl.col;
        ctx.fill();
        start += ang;
      });
    }

    function renderReview() {
      let html = '<table class="review-table"><thead><tr><th>#</th><th>Question</th><th>Your Answer</th><th>Correct</th><th>Status</th><th>Explanation</th></tr></thead><tbody>';
      mcqs.forEach((q, i) => {
        const a = answers[i];
        const yourAns = (a === null) ? 'Skipped' : (a !== undefined) ? `(${a}) ${q[a]}` : 'Not Attempted';
        const correctAns = `(${q.ans}) ${q[q.ans]}`;
        const status = (a === null) ? '<span class="skipped">Skipped</span>' : (a === q.ans) ? '<span class="correct">Correct</span>' : '<span class="incorrect">Wrong</span>';
        html += `<tr><td>${i + 1}</td><td>${q.q}</td><td>${yourAns}</td><td>${correctAns}</td><td>${status}</td><td>${q.expl}</td></tr>`;
      });
      html += '</tbody></table>';
      reviewSection.innerHTML = html;
    }

    document.getElementById("printBtn").onclick = () => {
      const fs = document.getElementById('finish-section');
      let original = document.body.innerHTML;
      document.body.innerHTML = fs.innerHTML;
      window.print();
      document.body.innerHTML = original;
      location.reload();
    };

    document.getElementById("pdfBtn").onclick = () => {
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      doc.setFontSize(15);
      doc.text("BIOLOGY TEST - VISHWAJEET SCIENCE ACADEMY", 105, 16, { align: "center" });
      doc.setFontSize(10);
      doc.text(resultDetails.innerText, 14, 26);
      doc.text(resultScore.innerText, 14, 32);
      doc.autoTable({ html: "#review-section table", startY: 40, theme: "grid", headStyles: { fillColor: [30, 144, 255] } });
      doc.save("structural Organisation in Animals.pdf");
    };

    document.getElementById("excelBtn").onclick = () => {
      let table = document.querySelector("#review-section table");
      if (!table) {
        alert("No review table.");
        return;
      }
      let html = table.outerHTML.replace(/ /g, "%20");
      let blob = new Blob([html], { type: 'application/vnd.ms-excel' });
      let link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "structural Organisation in Animals.xls";
      link.click();
      setTimeout(() => URL.revokeObjectURL(link.href), 1000);
    };
  </script>
</body>
</html>

