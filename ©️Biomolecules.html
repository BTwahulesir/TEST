<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Biology Test - Vishwajeet Science Academy</title>
<style>
body {
  font-family: 'Poppins', Arial, sans-serif;
  background: #f4f7fc;
  margin: 0;
  padding: 0;
  min-height: 100vh;
}
.page-border {
  min-height: 100vh;
  border: 6px solid #1e90ff;
  border-radius: 20px;
  margin: 0;
  background: white;
  box-shadow: 0 0 35px #a0befd;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding: 20px 0;
}
.container {width:97%;max-width:950px;margin:auto;display:flex;flex-direction:column;}
h2.main-title {text-align:center;margin-bottom:8px;font-size:1.65rem;color:#1c416b;font-weight:800;}
.sub-title {
  text-align: center;
  font-size: 2.1rem;
  margin: 0 0 28px 0;
  font-family: 'Algerian', serif, cursive;
  color: #1c416b;
  font-weight: 600;
  letter-spacing: 1px;
}
label {font-weight:600;margin:14px 0 7px;display:block;}
input[type=text], select {width:100%;padding:10px 12px;font-size:1.04em;border-radius:7px;border:1.4px solid #bbb;background:#f9f9fb;}
#startBtn {margin-top:20px;padding:14px 40px;font-size:1.12em;font-weight:700;border-radius:8px;background:#1e90ff;color:white;border:none;cursor:pointer;}
#startBtn:disabled {background:#a0bbd9;cursor:not-allowed;}
#startBtn:not(:disabled):hover {background:#1970dd;}
#quiz-section {display:none;margin-top:22px;gap:25px;}
#progress {text-align:center;margin-bottom:16px;font-size:1.1em;color:#555;}
.question-text {font-weight:700;font-size:1.22em;margin-bottom:17px;}
.options {margin-bottom:25px;}
.options label.option-label {display:flex;align-items:center;gap:13px;background:#f9f9f9;border:2px solid #eaeaea;border-radius:9px;margin-bottom:14px;font-size:1.08em;font-weight:500;cursor:pointer;transition:all 0.18s;min-height:48px;padding:0 20px;}
.options label.option-label:hover {border:2px solid #1976d2;background:#f0f9ff;box-shadow:0 2px 8px #1976d215;}
.options input[type="radio"] {accent-color:#1976d2;appearance:none;width:22px;height:22px;border:2px solid #bbb;border-radius:50%;background:#fff;margin-right:10px;}
.options input[type="radio"]:checked {border:7px solid #1976d2;background:#f3f8fd;}
.options label.option-label.selected {border:2.5px solid #1976d2;background:#eef6fb;}
.options .option-letter {font-weight:700;color:#1976d2;font-size:1.13em;padding-right:10px;}
#navigation {text-align:center;margin-top:12px;}
.nav-btn {padding:12px 26px;border-radius:8px;border:none;font-weight:700;font-size:1.1em;margin:0 10px;background:#1976d2;color:white;}
.nav-btn:hover:not(:disabled) {background:#065ab1;}
.nav-btn:disabled {background:#b9cce1;}
#submitBtn {margin-top:22px;padding:14px 42px;font-weight:700;font-size:1.2em;background:#238823;color:white;border:none;border-radius:9px;}
#submitBtn:disabled {background:#a8d1b7;}
#finish-section {display:none;margin-top:25px;}
.card {width:470px;max-width:96vw;background:white;border:3px solid #1e90ff;border-radius:22px;box-shadow:0 0 18px #7bb9fd;padding:30px 20px;text-align:center;margin:0 auto;}
.card h1 {font-size:1.4rem;margin-bottom:20px;color:#1c416b;}
.trophy {font-size:2.3rem;margin-bottom:15px;color:#ffbb1f;}
.details {font-size:1rem;font-weight:600;color:#444;margin-bottom:20px;}
.score {font-size:1.25rem;font-weight:800;margin-bottom:20px;}
.stats {display:flex;justify-content:center;gap:10px;flex-wrap:wrap;margin-bottom:20px;}
.stat {flex:1;background:#f5f8fa;border-radius:10px;padding:10px;text-align:center;min-width:80px;}
.stat-number {width:44px;height:44px;margin:0 auto 8px;border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:1.2em;}
.stat.attempted .stat-number {background:#197fd6;color:white;}
.stat.correct .stat-number {background:#08ad6c;color:white;}
.stat.wrong .stat-number {background:#d64541;color:white;}
.stat.notattempted .stat-number {background:#ddd;color:#333;}
#question-navigator {margin-left:24px;width:210px;display:grid;grid-template-columns:repeat(5,36px);grid-auto-rows:36px;gap:10px;}
.q-nav-btn {border-radius:6px;border:none;cursor:pointer;color:white;font-weight:700;}
.q-nav-btn.not-attempted {background:#d64541;}
.q-nav-btn.skipped {background:#197fd6;}
.q-nav-btn.attempted {background:#08ad6c;}
.q-nav-btn.current {outline:2px solid #000;}
table.review-table {width:100%;border-collapse:collapse;margin-top:15px;}
table.review-table th, table.review-table td {border:1px solid #ccc;padding:6px;}
.correct{color:#08ad6c;font-weight:bold;}
.incorrect{color:#d64541;font-weight:bold;}
.skipped{color:#197fd6;font-weight:bold;}
.export-btns {margin:22px auto 0 auto;display:flex;gap:15px;flex-wrap:wrap;justify-content:center;}
</style>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.1/jspdf.plugin.autotable.min.js"></script>
</head>
<body>
<div class="page-border">
<div class="container">
  <h2 class="main-title">BIOLOGY TEST - VISHWAJEET SCIENCE ACADEMY</h2>
  <h3 class="sub-title">&copy; By WAHULE SIR</h3>
  <div id="login-section">
    <label for="rollno">Enter Roll Number (01-200)</label>
    <input type="text" id="rollno" maxlength="3" placeholder="e.g. 01" />
    <label for="batch">Select Batch</label>
    <select id="batch">
      <option value="">-- Select Batch --</option>
      <option value="11th">11th</option>
      <option value="12th">12th</option>
      <option value="NEET Repeater">NEET Repeater</option>
    </select>
    <button id="startBtn" disabled>Start Test</button>
  </div>
  <section id="quiz-section">
    <div style="flex:1">
      <div id="progress"></div>
      <div id="question-block">
        <div class="question-text" id="question-text"></div>
        <form id="options-form" class="options"></form>
      </div>
      <div id="navigation">
        <button id="prevBtn" class="nav-btn" disabled>Previous</button>
        <button id="skipBtn" class="nav-btn">Skip</button>
        <button id="nextBtn" class="nav-btn" disabled>Next</button>
      </div>
      <button id="submitBtn" disabled>Submit Test</button>
    </div>
    <nav id="question-navigator"></nav>
  </section>
  <section id="finish-section">
    <div style="display:flex; flex-direction:column; align-items:center;">
      <div class="card">
        <h1><span class="trophy">&#x1F3C6;</span> Congratulations! Your Test has been Submitted <span class="trophy">&#x1F3C6;</span></h1>
        <div class="details" id="resultDetails"></div>
        <div id="resultScore" class="score"></div>
        <div class="stats">
          <div class="stat attempted"><div class="stat-number" id="attemptedCount">0</div><p>Attempted</p></div>
          <div class="stat correct"><div class="stat-number" id="correctCount">0</div><p>Correct</p></div>
          <div class="stat wrong"><div class="stat-number" id="wrongCount">0</div><p>Wrong</p></div>
          <div class="stat notattempted"><div class="stat-number" id="notAttemptedCount">0</div><p>Not Attempted</p></div>
        </div>
        <canvas id="piechart" width="220" height="220"></canvas>
        <div class="footer">¬© 2025 Vishwajeet Science Academy</div>
      </div>
      <div class="export-btns">
        <button class="nav-btn" id="printBtn" type="button">üñ®Ô∏è Print Report</button>
        <button class="nav-btn" id="pdfBtn" type="button">‚¨áÔ∏è Download PDF</button>
        <button class="nav-btn" id="excelBtn" type="button">‚¨áÔ∏è Export to Excel</button>
      </div>
    </div>
    <h2 id="review-heading" style="margin-top:36px;">Review Your Answers</h2>
    <div id="review-section"></div>
  </section>
</div>
</div>
<script>
/* --- Full 60 MCQs array here in {q,a,b,c,d,ans,expl} format --- */
const mcqs = [
  {q:"When carrot tissue is extracted with trichloroacetic acid, which molecule is most likely found only in the acid-soluble fraction?", a:"DNA", b:"Cellulose", c:"Glucose", d:"Starch", ans:"c", expl:"Glucose is a micromolecule and soluble in cold TCA."},
  {q:"Regarding the chemical composition of cells, which element is the second most abundant (by mass percentage), after oxygen?", a:"Hydrogen", b:"Calcium", c:"Carbon", d:"Phosphorus", ans:"c", expl:"Oxygen is ~65%, carbon ~18.5%."},
  {q:"Which component would NOT be present in the acid-insoluble fraction?", a:"Polysaccharides", b:"DNA", c:"Glycine", d:"Protein", ans:"c", expl:"Glycine is a micromolecule, acid soluble."},
  {q:"Which is a primary metabolite found in every living cell?", a:"Caffeine", b:"Fructose", c:"Morphine", d:"Glucosinolate", ans:"b", expl:"Fructose is part of central metabolism."},
  {q:"Assertion (A): Primary metabolites are always essential for cell function. Reason (R): Secondary metabolites like alkaloids do not participate in universal biochemical pathways.", a:"Both A and R are true, R explains A", b:"A true, R false", c:"A false, R true", d:"Both false", ans:"a", expl:"Primary metabolites are essential and universal; secondary metabolites have adaptive roles."},
  {q:"Match the following: A. Quinine 1. Primary Metabolite, B. Serine 2. Secondary Metabolite, C. Sucrose 3. Primary Metabolite, D. Codeine 4. Secondary Metabolite", a:"A-2, B-1, C-3, D-4", b:"A-2, B-3, C-1, D-4", c:"A-2, B-3, C-1, D-4", d:"A-2, B-1, C-4, D-3", ans:"a", expl:"Serine, sucrose: primary; quinine, codeine: secondary."},
  {q:"Identify the non-polymeric biomacromolecule:", a:"Lipid", b:"DNA", c:"Protein", d:"Starch", ans:"a", expl:"Lipids are not always true polymers."},
  {q:"Which macromolecule is composed exclusively of one type of monomer?", a:"Cellulose", b:"Protein", c:"DNA", d:"Hemoglobin", ans:"a", expl:"Cellulose‚Äîonly Œ≤-D-glucose."},
  {q:"Consider these statements: I. All amino acids are optically active, except glycine. II. At neutral pH, amino acids exist as zwitterions. III. Tyrosine is a nonpolar amino acid. IV. Proline does not have a primary amino group. Which are true?", a:"I, II, IV", b:"II, III", c:"I, III, IV", d:"I, II, III", ans:"a", expl:"Tyrosine is polar, proline‚Äôs amino group is secondary."},
  {q:"Which of the following would NOT alter a protein‚Äôs primary structure?", a:"Peptide bond hydrolysis", b:"Heat denaturation", c:"Mutation in gene coding the protein", d:"Substitution of an amino acid", ans:"b", expl:"Heat affects higher-order structures, not the sequence itself."},
  {q:"In hemoglobin, which level of structure involves interaction between Œ± and Œ≤ chains?", a:"Primary", b:"Secondary", c:"Tertiary", d:"Quaternary", ans:"d", expl:"Quaternary = interactions between separate polypeptide chains."},
  {q:"Which sugar is a component of RNA, but NOT DNA?", a:"Glucose", b:"Ribose", c:"Deoxyribose", d:"Fructose", ans:"b", expl:"RNA contains ribose, DNA contains deoxyribose."},
  {q:"Choose the correct property for cellulose:", a:"Branched, helical, digested by amylase", b:"Linear, not digested by most animals, Œ≤-linked", c:"Branched, iodine-positive, Œ±-linked", d:"Linear, Œ±-linked", ans:"b", expl:"Cellulose is linear and Œ≤-1,4 linked."},
  {q:"Which homopolysaccharide is found in fungal cell walls and insect exoskeletons?", a:"Cellulose", b:"Chitin", c:"Glycogen", d:"Inulin", ans:"b", expl:"Chitin is an N-acetylglucosamine polymer in these contexts."},
  {q:"Assertion (A): Amylose is water soluble. Reason (R): Amylose is a branched polymer that binds iodine.", a:"Both A and R true, R explains A", b:"Both true, R does not explain A", c:"A true, R false", d:"Both false", ans:"c", expl:"Amylose is unbranched but soluble; Amylopectin is branched."},
  {q:"Which is a component of a nucleotide, but NOT a nucleoside?", a:"Pentose", b:"Nitrogenous base", c:"Phosphate", d:"Ribose", ans:"c", expl:"Nucleoside = sugar + base; nucleotide = + phosphate."},
  {q:"Thymine is found in:", a:"Both DNA and RNA", b:"Only RNA", c:"Only DNA", d:"Neither DNA nor RNA", ans:"c", expl:"In RNA, uracil replaces thymine."},
  {q:"If a nucleic acid has 20% adenine and 20% guanine, what is its cytosine content, assuming it's double stranded and fully base paired?", a:"10%", b:"30%", c:"20%", d:"60%", ans:"c", expl:"A=T, G=C, so C=20%."},
  {q:"Which molecule contains only single bonds in its fatty acid chains?", a:"Palmitic acid", b:"Linoleic acid", c:"Oleic acid", d:"Linolenic acid", ans:"a", expl:"Palmitic acid is saturated."},
  {q:"Lecithin contains what additional group, not found in triglyceride?", a:"Sulphate", b:"Phosphate", c:"Amino", d:"Aldehyde", ans:"b", expl:"Phospholipid contains a phosphate group."},
  {q:"Which of the following is NOT always a property of an enzyme?", a:"Substrate specificity", b:"Catalytic power", c:"Composed of polypeptides only", d:"Affected by pH", ans:"c", expl:"Ribozymes (RNA) are also enzymes."},
  {q:"The rate of an enzyme-catalyzed reaction will increase with:", a:"Decrease in temperature", b:"Increase in substrate, up to Vmax", c:"Unlimited increase in substrate", d:"Decrease in enzyme concentration", ans:"b", expl:"Only up to saturation (Vmax)."},
  {q:"Match these: A. Kinase 1. Adds phosphate, B. Amylase 2. Digests starch, C. Lipase 3. Hydrolyses fats, D. Catalase 4. Removes H‚ÇÇO‚ÇÇ", a:"A-1, B-2, C-3, D-4", b:"A-2, B-1, C-3, D-4", c:"A-1, B-3, C-2, D-4", d:"A-2, B-3, C-1, D-4", ans:"a", expl:"Kinase adds phosphate, amylase digests starch, lipase hydrolyzes fat, catalase removes H‚ÇÇO‚ÇÇ."},
  {q:"Assertion (A): Some enzymes require metal ions for their activity. Reason (R): Metal ions can act as organic co-enzymes.", a:"Both A, R true, R explains A", b:"Both true, R does not explain A", c:"A true, R false", d:"Both false", ans:"c", expl:"Metal ions are inorganic cofactors; coenzymes are organic."},
  {q:"Two statements: I. All enzymes have an active site. II. The active site is always a rigid structure.", a:"Both true", b:"I true, II false", c:"I false, II true", d:"Both false", ans:"b", expl:"Active site is dynamic, not always rigid."},
  {q:"Which statements are correct? I. Amylase hydrolyzes Œ±-1,4 glycosidic bonds. II. Insulin is a dimeric protein with disulphide bridges. III. RuBisCO is the most abundant enzyme on Earth. IV. Glucagon stores carbohydrates in the liver.", a:"I, II, III", b:"II, III, IV", c:"I, III", d:"I, II, IV", ans:"c", expl:"Glucagon is a hormone, not a storage form."},
  {q:"Assertion (A): Œ≤-pleated sheet describes a secondary protein structure. Reason (R): Hydrogen bonds form between adjacent polypeptide chains.", a:"Both A, R true, R explains A", b:"Both true, R does not explain A", c:"A true, R false", d:"Both false", ans:"a", expl:"Œ≤-pleated sheet stabilized by H-bonds between chains."},
  {q:"An enzyme‚Äôs activity is lost after treatment with urea. This indicates:", a:"Urea breaks peptide bonds", b:"Urea denatures tertiary structure", c:"Urea digests enzymes", d:"Urea forms covalent bonds with side groups", ans:"b", expl:"Urea disrupts hydrogen bonding (denatures tertiary structure)."},
  {q:"Competitive enzyme inhibition can be reversed by:", a:"Increasing substrate concentration", b:"Increasing inhibitor concentration", c:"Lowering pH", d:"None of these", ans:"a", expl:"High substrate outcompetes inhibitor."},
  {q:"Match these molecular functions: A. Antibody 1. Movement, B. Actin 2. Immunity, C. Collagen 3. Structure, D. Trypsin 4. Catalyst", a:"A-2, B-1, C-3, D-4", b:"A-1, B-3, C-2, D-4", c:"A-4, B-2, C-1, D-3", d:"A-2, B-4, C-3, D-1", ans:"a", expl:"Antibody - immunity, Actin - movement, Collagen - structure, Trypsin - catalyst."},
  {q:"Which amino acid has a secondary amino group?", a:"Glycine", b:"Proline", c:"Serine", d:"Lysine", ans:"b", expl:"Proline's amino group is incorporated into its ring."},
  {q:"The main storage polysaccharide in plants:", a:"Glycogen", b:"Amylopectin", c:"Starch", d:"Inulin", ans:"c", expl:"Plants store carbohydrate mainly as starch."},
  {q:"If an organism lacks galactosidase, which dietary disaccharide will be most problematic to digest?", a:"Lactose", b:"Sucrose", c:"Maltose", d:"Cellobiose", ans:"a", expl:"Lactose digestion requires galactosidase."},
  {q:"DNA‚Äôs double helix is stabilized primarily by:", a:"Disulphide bonds", b:"Hydrophobic stacking", c:"Glycosidic bonds", d:"Ionic bonds", ans:"b", expl:"Base stacking (hydrophobic) stabilizes helix."},
  {q:"Match the molecule and main bond linking units: A. Protein 1. Glycosidic, B. DNA 2. Peptide, C. Amylose 3. Phosphodiester, D. Lipid 4. Ester", a:"A-2, B-3, C-1, D-4", b:"A-1, B-2, C-3, D-4", c:"A-2, B-1, C-4, D-3", d:"A-3, B-2, C-1, D-4", ans:"a", expl:"Protein - peptide; DNA - phosphodiester; amylose - glycosidic; lipid - ester."},
  {q:"Which are true? I. All carbohydrates are optically active. II. RNA contains ribose. III. Enzymes reduce activation energy. IV. Steroids are derived from terpenes.", a:"II, III", b:"I, II, III", c:"II, III, IV", d:"I, II, IV", ans:"c", expl:"Not all carbohydrates are optically active."},
  {q:"Which is NOT found in all amino acids (as per structure in solution)?", a:"Amino", b:"Carboxyl", c:"Phosphate", d:"Hydrogen", ans:"c", expl:"Phosphate is not present in all amino acids."},
  {q:"Peptide bonds are formed between:", a:"Amine group and side chain", b:"Carboxyl group and amine group", c:"Two carboxyl groups", d:"Two side chains", ans:"b", expl:"Peptide bond links carboxyl and amino groups of adjacent amino acids."},
  {q:"Maximum velocity (Vmax) of enzyme is achieved when:", a:"All active sites occupied", b:"Substrate concentration is low", c:"Enzyme inhibited", d:"All enzyme is denatured", ans:"a", expl:"Vmax: all enzyme molecules are substrate-bound."},
  {q:"Michaelis constant (Km) is:", a:"Substrate at half-maximal velocity", b:"Enzyme at Vmax", c:"Inhibitor concentration", d:"Amount of product formed", ans:"a", expl:"Km = substrate concentration at 1/2 Vmax."},
  {q:"Which is true for all macromolecules?", a:"Polymerized by condensation", b:"Composed of identical subunits only", c:"Soluble in organic solvents", d:"Structures never have branching", ans:"a", expl:"All macromolecules are polymerized by condensation/dehydration reactions."},
  {q:"In a DNA double helix, if thymine is 15%, what is guanine content?", a:"15%", b:"35%", c:"20%", d:"70%", ans:"b", expl:"A=T=15%; G+C=70%; G=35%."},
  {q:"An amino acid with nonpolar side chain, pI above pH 6, and not essential in humans is:", a:"Alanine", b:"Leucine", c:"Lysine", d:"Serine", ans:"a", expl:"Alanine: nonpolar, non-essential, pI ~6."},
  {q:"Which is NOT derived from monosaccharides?", a:"Starch", b:"DNA", c:"Citric acid", d:"Cellulose", ans:"c", expl:"Citric acid is not a carbohydrate polymer."},
  {q:"Which is NOT a function of structural proteins?", a:"Collagen providing tensile strength", b:"Tubulin making up microtubules", c:"Albumin acting as enzyme", d:"Keratin in hair", ans:"c", expl:"Albumin is chiefly transport/buffering; not structural enzyme."},
  {q:"Which is the correct statement?", a:"ATP contains ribose", b:"DNA uses uracil", c:"Cellulose is branched", d:"Amylose binds protein covalently", ans:"a", expl:"ATP uses ribose as sugar."},
  {q:"Which enzyme catalyzes the joining of Okazaki fragments?", a:"DNA polymerase", b:"RNA polymerase", c:"DNA ligase", d:"DNA helicase", ans:"c", expl:"DNA ligase forms phosphodiester bonds."},
  {q:"Peptidoglycan is present in:", a:"Animal cell wall", b:"Plant cell wall", c:"Fungal cell wall", d:"Bacterial cell wall", ans:"d", expl:"Bacterial cell wall contains peptidoglycan."},
  {q:"Biotin acts as:", a:"Vitamin B12", b:"Coenzyme for carboxylases", c:"Metal ion", d:"Structural protein", ans:"b", expl:"Biotin is a coenzyme."},
  {q:"Which statement about NAD+ is correct?", a:"It is a protein", b:"It participates only in anabolism", c:"It is an electron carrier", d:"It is a prosthetic group", ans:"c", expl:"NAD+ accepts and carries electrons."},
  {q:"Match: A. Glucose 1. C‚ÇÜH‚ÇÅ‚ÇÇO‚ÇÜ, B. Palmitic acid 2. C‚ÇÅ‚ÇÜH‚ÇÉ‚ÇÇO‚ÇÇ, C. Glycine 3. C‚ÇÇH‚ÇÖNO‚ÇÇ, D. Adenine 4. C‚ÇÖH‚ÇÖN‚ÇÖ", a:"A-1, B-2, C-3, D-4", b:"A-3, B-1, C-4, D-2", c:"A-4, B-1, C-2, D-3", d:"A-1, B-3, C-2, D-4", ans:"a", expl:"Each formula matches the named molecule."},
  {q:"A hospital finds a patient cannot digest starch but can digest protein. Which enzyme is likely inactive?", a:"Pepsin", b:"Lipase", c:"Amylase", d:"Lactase", ans:"c", expl:"Amylase breaks down starch."},
  {q:"Which molecular weight cutoff is used by NCERT to distinguish micromolecules?", a:"100 Da", b:"500 Da", c:"1000 Da", d:"10,000 Da", ans:"c", expl:"1000 Da separates micromolecules from macromolecules per NCERT."},
  {q:"Amino group in amino acid is:", a:"‚ÄìCOOH", b:"‚ÄìNH‚ÇÇ", c:"‚ÄìCHO", d:"‚ÄìOH", ans:"b", expl:"Amino group is NH‚ÇÇ."},
  {q:"In acid hydrolysis of proteins, which remains unbroken?", a:"Peptide bonds", b:"Disulphide bonds", c:"Hydrogen bonds", d:"All break", ans:"b", expl:"Disulphide bonds are more stable in acid."},
  {q:"The sugar in a nucleoside of DNA is always:", a:"Ribose", b:"Deoxyribose", c:"Glucose", d:"Fructose", ans:"b", expl:"DNA contains deoxyribose as sugar."},
  {q:"True/False: A single polypeptide can form a quaternary structure on its own.", a:"True", b:"False", c:"Depends on folding", d:"Only in enzymes", ans:"b", expl:"Quaternary structure always involves >1 polypeptide."},
  {q:"True/False: Starch and glycogen both give blue colour with iodine.", a:"True", b:"False", c:"Starch only", d:"Glycogen only", ans:"c", expl:"Starch = blue, glycogen = red-brown with iodine."},
  {q:"True/False: Proline lacks a free amino group.", a:"True", b:"False", c:"Only if methylated", d:"See context", ans:"a", expl:"Proline's amino group is secondary and not free."},
  {q:"True/False: All biomolecules are optically active.", a:"True", b:"False", c:"Only peptides", d:"Only glucose", ans:"b", expl:"Glycine, among others, is NOT optically active."}
];

const rollInput=document.getElementById('rollno');
const batchSelect=document.getElementById('batch');
const startBtn=document.getElementById('startBtn');
const quizSection=document.getElementById('quiz-section');
const progressDiv=document.getElementById('progress');
const questionText=document.getElementById('question-text');
const optionsForm=document.getElementById('options-form');
const prevBtn=document.getElementById('prevBtn');
const nextBtn=document.getElementById('nextBtn');
const skipBtn=document.getElementById('skipBtn');
const submitBtn=document.getElementById('submitBtn');
const finishSection=document.getElementById('finish-section');
const resultDetails=document.getElementById('resultDetails');
const resultScore=document.getElementById('resultScore');
const attemptedCount=document.getElementById('attemptedCount');
const correctCount=document.getElementById('correctCount');
const wrongCount=document.getElementById('wrongCount');
const notAttemptedCount=document.getElementById('notAttemptedCount');
const reviewSection=document.getElementById('review-section');
const pieCanvas=document.getElementById('piechart');
const questionNavigator=document.getElementById('question-navigator');

let currentQuestionIndex=0;
let answers=new Array(mcqs.length).fill(undefined);

function validateInput(){
  const roll=parseInt(rollInput.value.trim(),10);
  startBtn.disabled=!(roll>=1 && roll<=200 && batchSelect.value);
}
rollInput.addEventListener('input',()=>{rollInput.value=rollInput.value.replace(/\D/g,'');validateInput();});
batchSelect.addEventListener('change',validateInput);

startBtn.onclick=()=>{ document.getElementById('login-section').style.display='none'; quizSection.style.display='flex'; renderNavigator(); loadQuestion(0); };

function renderNavigator(){
  questionNavigator.innerHTML='';
  mcqs.forEach((q,i)=>{
    let btn=document.createElement('button');
    btn.textContent=i+1;
    btn.className='q-nav-btn not-attempted';
    btn.dataset.index=i;
    btn.onclick=()=>loadQuestion(i);
    questionNavigator.appendChild(btn);
  });
}
function updateNavigatorColors(){
  questionNavigator.querySelectorAll('.q-nav-btn').forEach(btn=>{
    const idx=+btn.dataset.index;
    btn.classList.remove('attempted','skipped','not-attempted','current');
    if(idx===currentQuestionIndex) btn.classList.add('current');
    if(answers[idx]===undefined) btn.classList.add('not-attempted');
    else if(answers[idx]===null) btn.classList.add('skipped');
    else btn.classList.add('attempted');
  });
}
function loadQuestion(i){
  currentQuestionIndex=i;
  const q=mcqs[i];
  questionText.textContent=`Q${i+1}. ${q.q}`;
  optionsForm.innerHTML='';
  ['a','b','c','d'].forEach(key=>{
    const lbl=document.createElement('label');
    lbl.className='option-label';
    lbl.innerHTML=`<input type="radio" name="option" value="${key}"><span class="option-letter">(${key.toUpperCase()})</span>${q[key]}`;
    optionsForm.appendChild(lbl);
  });
  optionsForm.querySelectorAll('input[type="radio"]').forEach(radio=>{
    radio.addEventListener('change',()=>{
      optionsForm.querySelectorAll('label.option-label').forEach(lbl=>lbl.classList.remove('selected'));
      radio.closest('label').classList.add('selected');
      nextBtn.disabled=false;
    });
  });
  if (answers[i]) {
    const sel=optionsForm.querySelector(`input[value="${answers[i]}"]`);
    if(sel){ sel.checked=true; sel.closest('label').classList.add('selected'); nextBtn.disabled=false; }
    else { nextBtn.disabled=true;}
  } else { nextBtn.disabled=true; }
  prevBtn.disabled=(i===0);
  progressDiv.textContent=`Question ${i+1} of ${mcqs.length}`;
  updateNavigatorColors();
}

prevBtn.onclick=()=>{ if(currentQuestionIndex>0) loadQuestion(currentQuestionIndex-1); };
nextBtn.onclick=()=>{ const sel=optionsForm.querySelector('input[name="option"]:checked'); if(sel) answers[currentQuestionIndex]=sel.value; submitBtn.disabled=false; if(currentQuestionIndex<mcqs.length-1) loadQuestion(currentQuestionIndex+1); };
skipBtn.onclick=()=>{ answers[currentQuestionIndex]=null; submitBtn.disabled=false; if(currentQuestionIndex<mcqs.length-1) loadQuestion(currentQuestionIndex+1); };
submitBtn.onclick=()=>{ if(confirm('Submit test?')) finalizeTest(); };

function finalizeTest(){
  quizSection.style.display='none';
  finishSection.style.display='block';
  const total = mcqs.length;
  const correct = answers.filter((a,i)=>a === mcqs[i].ans).length;
  const wrong = answers.filter((a,i)=>a !== null && a !== undefined && a !== mcqs[i].ans).length;
  const attempted = answers.filter(a=>a !== null && a !== undefined).length;
  const skipped = answers.filter(a=>a === null).length;
  const notAttempted = answers.filter(a=>a === undefined).length;
  const score = correct*4 - wrong;
  const pct = ((score/(total*4))*100).toFixed(2);

  resultDetails.innerHTML=`<strong>Roll Number:</strong> ${rollInput.value.padStart(2,'0')}<br><strong>Batch:</strong> ${batchSelect.value}`;
  resultScore.textContent=`Score: ${score} / ${total*4} (${pct}%)`;
  resultScore.style.color=score>=0 ? '#08ad6c' : '#d64541';
  attemptedCount.textContent=attempted;
  correctCount.textContent=correct;
  wrongCount.textContent=wrong;
  notAttemptedCount.textContent=notAttempted;
  drawPieChart(correct, wrong, skipped);
  renderReview();
}
function drawPieChart(c,w,s){
  const ctx=pieCanvas.getContext('2d');
  const total=c+w+s || 1; const cx=110, cy=110, r=100;
  ctx.clearRect(0,0,pieCanvas.width,pieCanvas.height);
  let start=-Math.PI/2;
  const slices=[{v:c,col:'#08ad6c'},{v:w,col:'#d64541'},{v:s,col:'#197fd6'}];
  slices.forEach(sl=>{ if(!sl.v) return; const ang=(sl.v/total)*2*Math.PI; ctx.beginPath(); ctx.moveTo(cx,cy); ctx.arc(cx,cy,r,start,start+ang); ctx.closePath(); ctx.fillStyle=sl.col; ctx.fill(); start+=ang; });
}
function renderReview(){
  let html='<table class="review-table"><thead><tr><th>#</th><th>Question</th><th>Your Answer</th><th>Correct</th><th>Status</th><th>Explanation</th></tr></thead><tbody>';
  mcqs.forEach((q,i)=>{
    const a = answers[i];
    const yourAns=(a===null)?'Skipped':(a!==undefined)?`(${a}) ${q[a]}`:'Not Attempted';
    const correctAns=`(${q.ans}) ${q[q.ans]}`;
    const status=(a===null)?'<span class="skipped">Skipped</span>':(a===q.ans)?'<span class="correct">Correct</span>':'<span class="incorrect">Wrong</span>';
    html+=`<tr><td>${i+1}</td><td>${q.q}</td><td>${yourAns}</td><td>${correctAns}</td><td>${status}</td><td>${q.expl}</td></tr>`;
  });
  html+='</tbody></table>'; reviewSection.innerHTML=html;
}
document.getElementById("printBtn").onclick=()=>{const fs=document.getElementById('finish-section');let original=document.body.innerHTML;document.body.innerHTML=fs.innerHTML;window.print();document.body.innerHTML=original;location.reload();};
document.getElementById("pdfBtn").onclick=()=>{const { jsPDF }=window.jspdf;const doc=new jsPDF();doc.setFontSize(15);doc.text("BIOLOGY TEST - VISHWAJEET SCIENCE ACADEMY",105,16,{align:"center"});doc.setFontSize(10);doc.text(resultDetails.innerText,14,26);doc.text(resultScore.innerText,14,32);doc.autoTable({html:"#review-section table",startY:40,theme:"grid",headStyles:{fillColor:[30,144,255]}});doc.save("Biology_Test_Result.pdf");};
document.getElementById("excelBtn").onclick=()=>{let table=document.querySelector("#review-section table");if(!table){alert("No review table.");return;}let html=table.outerHTML.replace(/ /g,"%20");let blob=new Blob([html],{type:'application/vnd.ms-excel'});let link=document.createElement("a");link.href=URL.createObjectURL(blob);link.download="Biology_Test_Result.xls";link.click();setTimeout(()=>URL.revokeObjectURL(link.href),1000);};
</script>
</body>
</html>
