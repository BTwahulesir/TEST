<style>
  body {
    font-family: Arial, sans-serif;
    max-width: 700px;
    margin: 30px auto;
    background: #f9f9f9;
  }
  .container {
    background: white;
    padding: 20px 25px 25px;
    border-radius: 10px;
    box-shadow: 0 0 20px #ccc;
  }
  h2 {
    color: #1b537e;
    margin-bottom: 10px;
  }
  .option {
    margin: 8px 0;
    display: block;
  }
  .score {
    font-size: 1.2em;
    margin: 12px 0;
    background: #ecf5fa;
    padding: 10px 15px;
    border-radius: 7px;
    display: inline-block;
  }
  .explanation {
    margin: 15px 0 0 0;
    padding: 10px 15px;
    border-left: 4px solid #439967;
    background: #f5fff2;
    display: none;
  }
  .finish {
    text-align: center;
    font-size: 22px;
    padding: 20px;
  }
  .btn {
    background: #1975a5;
    color: white;
    border: none;
    padding: 11px 20px;
    border-radius: 5px;
    cursor: pointer;
    font-size: 1em;
    margin-top: 10px;
  }
  .btn:disabled {
    background: #aaa;
    cursor: not-allowed;
  }
  #progress {
    margin-top: 8px;
    color: #666;
  }
  .review {
    margin: 20px 0;
  }
  .review table {
    border-collapse: collapse;
    width: 100%;
  }
  .review th,
  .review td {
    border: 1px solid #ccc;
    padding: 8px;
  }
  .correct {
    color: green;
  }
  .incorrect {
    color: #b9140e;
  }
</style>

<div class="container" id="quiz-container">
  <h2>NCERT Class 11 Structural Organisation in Animals (100 MCQs)</h2>
  <div class="score" id="score">Score: 0</div>
  <div id="progress"></div>
  <div id="question-area"></div>
  <div class="explanation" id="explanation"></div>
  <button class="btn" id="nextBtn" disabled>Next</button>
</div>

<div class="container finish" id="finish-screen" style="display:none;">
  <b>Quiz Completed!</b><br />
  <div id="finalScore"></div>
  <button class="btn" id="reviewBtn">Review All Questions</button>
  <div id="reviewSection" class="review" style="display:none;"></div>
</div>

<script>
  // Full questions array (first 10 for demo; replace or expand as needed)
  const mcqs = [
    { q: "The tissue with negligible intercellular matrix is", a: "Muscular", b: "Nervous", c: "Epithelial", d: "Connective", ans: "c", expl: "Epithelial tissue: tightly packed cells; little matrix" },
    { q: "Which of the following lines alveoli of lungs?", a: "Cuboidal epithelium", b: "Squamous epithelium", c: "Ciliated epithelium", d: "Columnar epithelium", ans: "b", expl: "Squamous epithelium is thin, allows exchange" },
    { q: "Dense regular connective tissue forms", a: "Ligaments", b: "Tendons", c: "Both (a) and (b)", d: "Cartilage", ans: "c", expl: "Tendons/ligaments: both dense regular connective tissue" },
    { q: "Adipose tissue mainly stores", a: "Protein", b: "Fat", c: "Water", d: "Mineral", ans: "b", expl: "Adipose stores fat" },
    { q: "Frog’s respiratory organs include", a: "Lung only", b: "Skin only", c: "Skin, lungs, buccal cavity", d: "Gill", ans: "c", expl: "Frogs respire by skin, lung, buccal cavity" },
    { q: "Nucleus is absent in", a: "Red blood cells", b: "Neutrophils", c: "Platelets", d: "Monocytes", ans: "a", expl: "Mammalian RBCs lack nucleus" },
    { q: "The matrix of bone contains primarily", a: "Chondrin", b: "Keratin", c: "Calcium salts", d: "Collagen", ans: "c", expl: "Bones: matrix of calcium salts and collagen" },
    { q: "Which tissue is responsible for contraction and movement?", a: "Muscular tissue", b: "Connective tissue", c: "Epithelial tissue", d: "Nervous tissue", ans: "a", expl: "Only muscle tissue contracts" },
    { q: "The frog’s heart is", a: "Two-chambered", b: "Three-chambered", c: "Four-chambered", d: "Single chambered", ans: "b", expl: "Two atria, one ventricle" },
    { q: "Intercalated discs are present in", a: "Smooth muscles", b: "Cardiac muscles", c: "Skeletal muscles", d: "None", ans: "b", expl: "Intercalated discs in cardiac muscle" }
    // Add remaining questions similarly...
  ];

  let qIndex = 0;
  let score = 0;
  const userAnswers = [];

  const questionArea = document.getElementById("question-area");
  const explanationBox = document.getElementById("explanation");
  const nextBtn = document.getElementById("nextBtn");
  const scoreBox = document.getElementById("score");
  const progressBox = document.getElementById("progress");
  const quizContainer = document.getElementById("quiz-container");
  const finishScreen = document.getElementById("finish-screen");
  const finalScore = document.getElementById("finalScore");
  const reviewBtn = document.getElementById("reviewBtn");
  const reviewSection = document.getElementById("reviewSection");

  function loadQuestion() {
    explanationBox.style.display = "none";
    nextBtn.disabled = true;

    let current = mcqs[qIndex];
    progressBox.textContent = `Question ${qIndex + 1} of ${mcqs.length}`;
    questionArea.innerHTML = `
      <div><b>Q${qIndex + 1}.</b> ${current.q}</div>
      <label class="option"><input type="radio" name="opt" value="a"> (a) ${current.a}</label>
      <label class="option"><input type="radio" name="opt" value="b"> (b) ${current.b}</label>
      <label class="option"><input type="radio" name="opt" value="c"> (c) ${current.c}</label>
      <label class="option"><input type="radio" name="opt" value="d"> (d) ${current.d}</label>
    `;

    // Add event listeners to inputs
    const options = questionArea.querySelectorAll("input[name='opt']");
    options.forEach((opt) => {
      opt.addEventListener("change", () => {
        nextBtn.disabled = false;
      });
    });
  }

  function showExplanation(chosen) {
    const current = mcqs[qIndex];
    const correctOptionText = current[current.ans];
    const isCorrect = chosen === current.ans;

    if (isCorrect) {
      score += 4;
    } else {
      score -= 1;
    }
    scoreBox.textContent = `Score: ${score}`;

    explanationBox.innerHTML = `
      <b>Correct Answer:</b> (${current.ans}) ${correctOptionText}<br>
      <b>Explanation:</b> ${current.expl}<br>
      <span class="${isCorrect ? "correct" : "incorrect"}"><b>${isCorrect ? "+4" : "–1"} marks</b></span>
    `;
    explanationBox.style.display = "block";

    userAnswers[qIndex] = {
      question: current.q,
      chosenAnswer: chosen,
      chosenText: current[chosen],
      correctAnswer: current.ans,
      correctText: correctOptionText,
      isCorrect: isCorrect,
    };

    nextBtn.disabled = true;
  }

  nextBtn.addEventListener("click", () => {
    // find selected option
    const selectedInput = document.querySelector('input[name="opt"]:checked');
    if (!selectedInput) return; // should not happen, button disabled otherwise

    if (explanationBox.style.display === "none") {
      // first click shows explanation
      showExplanation(selectedInput.value);
      // Change button text to Next Question or Finish
      nextBtn.textContent = qIndex === mcqs.length - 1 ? "Finish" : "Next Question";
      nextBtn.disabled = false;
    } else {
      // second click moves to next question or finish
      qIndex++;
      if (qIndex === mcqs.length) {
        showResult();
      } else {
        loadQuestion();
        nextBtn.textContent = "Next";
      }
    }
  });

  function showResult() {
    quizContainer.style.display = "none";
    finishScreen.style.display = "block";
    finalScore.innerHTML = `Your NEET-style score: <b>${score} / ${mcqs.length * 4}</b>`;
  }

  reviewBtn.addEventListener("click", () => {
    reviewSection.style.display = "block";
    if (reviewSection.innerHTML.trim()) {
      // Already generated
      return;
    }
    let html = "<h3>Review: Your Answers</h3><table><tr><th>No.</th><th>Question</th><th>Your Answer</th><th>Correct Answer</th><th>Marks</th></tr>";
    userAnswers.forEach((ua, i) => {
      if (!ua) return;
      html += `<tr>
        <td>${i + 1}</td>
        <td>${ua.question}</td>
        <td>(${ua.chosenAnswer}) ${ua.chosenText}</td>
        <td>(${ua.correctAnswer}) ${ua.correctText}</td>
        <td class="${ua.isCorrect ? "correct" : "incorrect"}">${ua.isCorrect ? "+4" : "–1"}</td>
      </tr>`;
    });
    html += "</table>";
    reviewSection.innerHTML = html;
  });

  // Initialize first question on load
  window.onload = () => {
    loadQuestion();
  };
</script>